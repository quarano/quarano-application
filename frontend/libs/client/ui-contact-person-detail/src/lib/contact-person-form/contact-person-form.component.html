<form [formGroup]="formGroup" (ngSubmit)="onSubmit()">
  <mat-card class="form__card--small form__card--animated">
    <mat-card-header>
      <div mat-card-avatar class="header-image"></div>
      <mat-card-title>{{
        isNew
          ? ('CONTACT_PERSON_FORM.NEUE_KONTAKTPERSON_ANLEGEN' | translate)
          : ('CONTACT_PERSON_FORM.KONTAKTPERSON_BEARBEITEN' | translate)
      }}</mat-card-title>
      <mat-card-subtitle>{{ 'CONTACT_PERSON_FORM.PFLICHTEINGABEN_SIND_MARKIERT' | translate }}</mat-card-subtitle>
    </mat-card-header>
    <mat-card-content>
      <mat-form-field class="half-width">
        <input
          matInput
          [placeholder]="'CONTACT_PERSON_FORM.VORNAME' | translate"
          formControlName="firstName"
          type="text"
          #first_name_input
          (blur)="trimValue(first_name_input)"
          data-cy="contact-person-form-first-name"
        />
        <mat-error *ngFor="let error of validationErrorService.getErrorKeys(formGroup.controls.firstName)">
          {{ validationErrorService.getErrorMessage(formGroup.controls.firstName, error) | async }}
        </mat-error>
      </mat-form-field>
      <mat-form-field class="half-width">
        <input
          matInput
          [placeholder]="'CONTACT_PERSON_FORM.NACHNAME' | translate"
          formControlName="lastName"
          type="text"
          #last_name_input
          (blur)="trimValue(first_name_input)"
          data-cy="contact-person-form-last-name"
        />
        <mat-error *ngFor="let error of validationErrorService.getErrorKeys(formGroup.controls.lastName)">
          {{ validationErrorService.getErrorMessage(formGroup.controls.lastName, error) | async }}
        </mat-error>
      </mat-form-field>
      <fieldset class="mb-3">
        <legend>{{ 'CONTACT_PERSON_FORM.KONTAKTMÖGLICHKEITEN' | translate }} *</legend>
        <mat-form-field class="full-width" data-cy="contact-person-form-phone">
          <input
            matInput
            maxlength="17"
            minlength="5"
            [placeholder]="'CONTACT_PERSON_FORM.TELEFONNUMMER_FESTNETZ' | translate"
            formControlName="phone"
            type="phone"
            #phone_input
            (blur)="trimValue(phone_input)"
          />
          <mat-error *ngFor="let error of validationErrorService.getErrorKeys(formGroup.controls.phone)">
            {{ validationErrorService.getErrorMessage(formGroup.controls.phone, error) | async }}
          </mat-error>
        </mat-form-field>
        <mat-form-field class="full-width" data-cy="contact-person-form-mobile-phone2">
          <input
            data-cy="input-mobilePhone"
            matInput
            maxlength="17"
            minlength="5"
            [placeholder]="'CONTACT_PERSON_FORM.TELEFONNUMMER_MOBIL' | translate"
            formControlName="mobilePhone"
            type="phone"
            #mobile_phone_input
            (blur)="trimValue(mobile_phone_input)"
            data-cy="contact-person-form-mobile-phone"
          />
          <mat-error *ngFor="let error of validationErrorService.getErrorKeys(formGroup.controls.mobilePhone)">
            {{ validationErrorService.getErrorMessage(formGroup.controls.mobilePhone, error) | async }}
          </mat-error>
        </mat-form-field>
        <mat-form-field class="full-width">
          <input
            matInput
            [placeholder]="'CONTACT_PERSON_FORM.E_MAIL' | translate"
            formControlName="email"
            type="email"
            #email_input
            (blur)="trimValue(email_input)"
          />
          <mat-error *ngFor="let error of validationErrorService.getErrorKeys(formGroup.controls.email)">
            {{ validationErrorService.getErrorMessage(formGroup.controls.email, error) | async }}
          </mat-error>
        </mat-form-field>
        <mat-form-field class="full-width" [class]="showIdentificationHintField ? '' : 'display-none'">
          <mat-label>{{ 'CONTACT_PERSON_FORM.HINWEISE_ZUR_IDENTIFIKATION' | translate }}</mat-label>
          <textarea
            [mat-autosize]="true"
            [matAutosizeMinRows]="8"
            matInput
            formControlName="identificationHint"
            [placeholder]="'CONTACT_PERSON_FORM.BITTE_GEBEN_SIE_UNS_WEITERE_HINWEISE' | translate"
          ></textarea>
          <mat-error>{{ 'CONTACT_PERSON_FORM.MINDESTENS_EINE_KONTAKTMÖGLICHKEIT' | translate }}</mat-error>
          <mat-error *ngFor="let error of validationErrorService.getErrorKeys(formGroup.controls.identificationHint)">
            {{ validationErrorService.getErrorMessage(formGroup.controls.identificationHint, error) | async }}
          </mat-error>
        </mat-form-field>
      </fieldset>
      <fieldset class="mb-3">
        <legend>{{ 'CONTACT_PERSON_FORM.ADRESSE' | translate }}</legend>
        <mat-form-field style="width: 70%">
          <input
            matInput
            [placeholder]="'CONTACT_PERSON_FORM.STRASSE' | translate"
            formControlName="street"
            type="text"
            #street_input
            (blur)="trimValue(street_input)"
          />
          <mat-error *ngFor="let error of validationErrorService.getErrorKeys(formGroup.controls.street)">
            {{ validationErrorService.getErrorMessage(formGroup.controls.street, error) | async }}
          </mat-error>
        </mat-form-field>
        <mat-form-field style="width: 30%">
          <input
            matInput
            [placeholder]="'CONTACT_PERSON_FORM.HAUSNUMMER' | translate"
            maxlength="6"
            formControlName="houseNumber"
            type="text"
            #house_number_input
            (blur)="trimValue(house_number_input)"
          />
          <mat-error *ngFor="let error of validationErrorService.getErrorKeys(formGroup.controls.houseNumber)">
            {{ validationErrorService.getErrorMessage(formGroup.controls.houseNumber, error) | async }}
          </mat-error>
        </mat-form-field>
        <mat-form-field style="width: 30%">
          <input
            matInput
            [placeholder]="'CONTACT_PERSON_FORM.POSTLEITZAHL' | translate"
            formControlName="zipCode"
            type="text"
            #zip_code_input
            (blur)="trimValue(zip_code_input)"
          />
          <mat-error *ngFor="let error of validationErrorService.getErrorKeys(formGroup.controls.zipCode)">
            {{ validationErrorService.getErrorMessage(formGroup.controls.zipCode, error) | async }}
          </mat-error>
        </mat-form-field>
        <mat-form-field style="width: 70%">
          <input
            matInput
            [placeholder]="'CONTACT_PERSON_FORM.ORT' | translate"
            formControlName="city"
            type="text"
            #city_input
            (blur)="trimValue(city_input)"
          />
          <mat-error *ngFor="let error of validationErrorService.getErrorKeys(formGroup.controls.city)">
            {{ validationErrorService.getErrorMessage(formGroup.controls.city, error) | async }}
          </mat-error>
        </mat-form-field>
      </fieldset>
      <fieldset class="mb-3">
        <legend>{{ 'CONTACT_PERSON_FORM.RISIKOEINSCHÄTZUNG' | translate }}</legend>
        <div class="alert">{{ 'CONTACT_PERSON_FORM.FOLGENDE_AUSSAGEN_ÜBER_KONTAKTPERSON' | translate }}</div>
        <div style="display: flex; flex-direction: column">
          <div class="risk-question">
            <mat-label id="example-radio-group-label">{{
              'CONTACT_PERSON_FORM.MEDIZINISCHES_UMFELD' | translate
            }}</mat-label>
            <mat-radio-group
              aria-labelledby="example-radio-group-label"
              class="example-radio-group"
              formControlName="isHealthStaff"
            >
              <mat-radio-button class="example-radio-button" [value]="true">
                {{ 'CONTACT_PERSON_FORM.JA' | translate }}
              </mat-radio-button>
              <mat-radio-button class="example-radio-button" [value]="false">
                {{ 'CONTACT_PERSON_FORM.NEIN' | translate }}
              </mat-radio-button>
              <mat-radio-button class="example-radio-button" [value]="null">
                {{ 'CONTACT_PERSON_FORM.DAS_WEISS_ICH_NICHT' | translate }}
              </mat-radio-button>
            </mat-radio-group>
          </div>
          <div class="risk-question">
            <mat-label id="example-radio-group-label">{{ 'CONTACT_PERSON_FORM.ÜBER_60' | translate }}</mat-label>
            <mat-radio-group
              aria-labelledby="example-radio-group-label"
              class="example-radio-group"
              formControlName="isSenior"
            >
              <mat-radio-button class="example-radio-button" [value]="true">
                {{ 'CONTACT_PERSON_FORM.JA' | translate }}
              </mat-radio-button>
              <mat-radio-button class="example-radio-button" [value]="false">
                {{ 'CONTACT_PERSON_FORM.NEIN' | translate }}
              </mat-radio-button>
              <mat-radio-button class="example-radio-button" [value]="null">
                {{ 'CONTACT_PERSON_FORM.DAS_WEISS_ICH_NICHT' | translate }}
              </mat-radio-button>
            </mat-radio-group>
          </div>
          <div class="risk-question">
            <mat-label id="example-radio-group-label" style="display: flex; align-items: center"
              >{{ 'CONTACT_PERSON_FORM.BEKANNTE_VORERKRANKUNGEN' | translate
              }}<mat-icon
                class="ml-1"
                style="cursor: pointer"
                [matTooltip]="'CONTACT_PERSON_FORM.FOLGENDE_VORERKRANKUNGEN' | translate"
                matTooltipClass="qro-tooltip"
              >
                info</mat-icon
              ></mat-label
            >

            <mat-radio-group
              aria-labelledby="example-radio-group-label"
              class="example-radio-group"
              formControlName="hasPreExistingConditions"
            >
              <mat-radio-button class="example-radio-button" [value]="true">
                {{ 'CONTACT_PERSON_FORM.JA' | translate }}
              </mat-radio-button>
              <mat-radio-button class="example-radio-button" [value]="false">
                {{ 'CONTACT_PERSON_FORM.NEIN' | translate }}
              </mat-radio-button>
              <mat-radio-button class="example-radio-button" [value]="null">
                {{ 'CONTACT_PERSON_FORM.DAS_WEISS_ICH_NICHT' | translate }}
              </mat-radio-button>
            </mat-radio-group>
          </div>
        </div>
      </fieldset>
      <mat-form-field class="full-width">
        <mat-label>{{ 'CONTACT_PERSON_FORM.SONSTIGE_BEMERKUNGEN' | translate }}</mat-label>
        <textarea
          [mat-autosize]="true"
          [matAutosizeMinRows]="4"
          matInput
          formControlName="remark"
          [placeholder]="'CONTACT_PERSON_FORM.WEITERE_KOMMENTARE_ODER_HINWEISE' | translate"
        ></textarea>
        <mat-hint align="start"
          ><strong>{{ 'CONTACT_PERSON_FORM.WEITERE_KOMMENTARE_ODER_HINWEISE' | translate }}</strong>
        </mat-hint>
        <mat-error *ngFor="let error of validationErrorService.getErrorKeys(formGroup.controls.remark)">
          {{ validationErrorService.getErrorMessage(formGroup.controls.remark, error) | async }}
        </mat-error>
      </mat-form-field>
    </mat-card-content>
    <mat-card-actions>
      <qro-button data-cy="submit-button" [disabled]="formGroup.invalid || formGroup.pristine" [loading]="loading">
        {{ 'CONTACT_PERSON_FORM.SPEICHERN' | translate }}
      </qro-button>
      <button type="button" mat-raised-button color="secondary" (click)="cancel()">
        {{ 'CONTACT_PERSON_FORM.ABBRECHEN' | translate }}
      </button>
    </mat-card-actions>
  </mat-card>
</form>
